<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.springleaf.knowseek.mapper.mysql.OperationLogMapper">

    <resultMap id="resultMap" type="com.springleaf.knowseek.model.entity.OperationLog">
        <id property="id" column="id"/>
        <result property="userId" column="user_id"/>
        <result property="moduleName" column="module_name"/>
        <result property="ipAddress" column="ip_address"/>
        <result property="operationType" column="operation_type"/>
        <result property="description" column="description"/>
        <result property="requestUrl" column="request_url"/>
        <result property="requestMethod" column="request_method"/>
        <result property="requestParams" column="request_params"/>
        <result property="responseResult" column="response_result"/>
        <result property="responseMessage" column="response_message"/>
        <result property="operationTime" column="operation_time"/>
        <result property="executionTime" column="execution_time"/>
    </resultMap>

    <insert id="insert">
        INSERT INTO tb_operation_log (user_id, module_name, ip_address, operation_type, description, request_url, request_method, request_params, response_result, response_message, operation_time, execution_time)
        VALUES (#{userId}, #{moduleName}, #{ipAddress}, #{operationType}, #{description}, #{requestUrl}, #{requestMethod}, #{requestParams}, #{responseResult}, #{responseMessage}, #{operationTime}, #{executionTime})
    </insert>

    <select id="selectByCondition" resultMap="resultMap">
        SELECT * FROM tb_operation_log
        <where>
            <if test="userId != null">
                AND user_id = #{userId}
            </if>
            <if test="moduleName != null and moduleName != ''">
                AND module_name = #{moduleName}
            </if>
            <if test="operationType != null and operationType != ''">
                AND operation_type = #{operationType}
            </if>
            <if test="responseResult != null and responseResult != ''">
                AND response_result = #{responseResult}
            </if>
            <if test="startTime != null and startTime != ''">
                AND operation_time &gt;= #{startTime}
            </if>
            <if test="endTime != null and endTime != ''">
                AND operation_time &lt;= #{endTime}
            </if>
        </where>
        ORDER BY operation_time DESC
    </select>

</mapper>
