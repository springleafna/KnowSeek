server:
  port: 8181 # 指定端口号
spring:
  jackson:
    time-zone: GMT+8
  datasource:
    mysql:
      url: jdbc:mysql://120.26.236.122:33306/know_seek?useSSL=false&serverTimezone=Asia/Shanghai&allowPublicKeyRetrieval=true
      username: root
      password: YOUR_ROOT_PASSWORD
      driver-class-name: com.mysql.cj.jdbc.Driver
      type: com.zaxxer.hikari.HikariDataSource
      hikari:
        auto-commit: true
        maximum-pool-size: 25
        minimum-idle: 15
        idle-timeout: 300000     # 5分钟（必须 < max-lifetime）
        max-lifetime: 600000     # 10分钟
        connection-timeout: 30000
        validation-timeout: 5000  # 5秒，避免验证卡死
        pool-name: mysqlHikariCP
    pgvector:
      driver-class-name: org.postgresql.Driver
      username: springleaf
      password: Yjw123456#
      url: jdbc:postgresql://120.26.236.122:15432/know_seek
      type: com.zaxxer.hikari.HikariDataSource
      hikari:
        maximum-pool-size: 5
        minimum-idle: 2
        idle-timeout: 300000
        max-lifetime: 1200000       # 20分钟
        connection-timeout: 30000
        pool-name: pgvectorHikariCP
  data:
    redis:
      host: 120.26.236.122
      port: 56379
      username: default
      password: Yjw123456#
      lettuce:
        pool:
          enabled: true
          max-active: 8
          max-idle: 8
          min-idle: 2
          time-between-eviction-runs: 30000     # 每30秒检查一次空闲连接
          min-evictable-idle-time: 60000        # 连接空闲超过60秒可被回收
          test-while-idle: true                 # 空闲时检测连接有效性
          test-on-borrow: false                 # 借出时不检测（性能考虑）
          test-on-create: false
  servlet:
    multipart:
      enabled: true
      max-file-size: 50MB # 单个文件的最大大小
      max-request-size: 100MB # 整个请求的最大大小
  rabbitmq:
    host: 120.26.236.122
    port: 5672
    username: admin
    password: admin
    listener:
      simple:
        prefetch: 1 # 每次投递n个消息，消费完在投递n个
        retry:
          enabled: true
          max-attempts: 3 # 最大重试次数
          initial-interval: 1000ms # 初始重试间隔
          multiplier: 2.0 # 重试间隔倍数
          max-interval: 10000ms # 最大重试间隔
        default-requeue-rejected: false # 消费失败后不重新入队
    topic:
      file-processing-vectorize: file.processing.vectorize
  ai:
    # 使用 spring.ai.openai 的配置路径，因为灵码提供了 OpenAI 兼容接口
    openai:
      base-url: https://dashscope.aliyuncs.com/compatible-mode/v1
      api-key: sk-0393395839294d9491512a924a61d6b9

      # 聊天模型的相关配置
      chat:
        options:
          model: qwen-plus
          temperature: 0.7
          top-p: 0.8
          # enable_search: true # 是否开启搜索功能

      # 嵌入模型的相关配置
      embedding:
        options:
          model: text-embedding-v2
          dimensions: 1024
  elasticsearch:
    uris: 120.26.236.122:9200

mybatis:
  mapper-locations: classpath:/mapper/*
  configuration:
    map-underscore-to-camel-case: true
logging:
  level:
    com.springleaf.knowseek.mapper: DEBUG
    org.apache.ibatis: DEBUG
    org.apache.ibatis.logging.stdout.StdOutImpl: DEBUG
    org.springframework.web.client: DEBUG
    org.springframework.ai: DEBUG
# Sa-Token配置
sa-token:
  # token名称 (同时也是cookie名称)
  token-name: Authorization
  # token 有效期（单位：秒） 默认30天，-1 代表永久有效 这里是一天
  timeout: 86400
  # 是否允许同一账号并发登录 (为true时允许一起登录, 为false时新登录挤掉旧登录)
  is-concurrent: true
  # 在多人登录同一账号时，是否共用一个token (为true时所有登录共用一个token, 为false时每次登录新建一个token)
  is-share: true
  # token风格
  token-style: uuid
  # 是否输出操作日志
  is-log: true
  # 关闭从 Cookie 读取
  is-read-cookie: false
# 阿里云OSS配置
aliyun:
  oss:
    endpoint: oss-cn-hangzhou.aliyuncs.com
    bucket-name: know-seek-bucket
    # 分片预签名URL过期时间（单位：秒）
    presigned-url-expiration: 900